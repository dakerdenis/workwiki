<?php
    // (B) SAVE CONTENT ON FORM SUBMIT
    if (isset($_POST["content"])) {
      // (B1) CONNECT TO DATABASE
      require "2-database.php";

      // (B2) SAVE
      // NOTE - CONTENT ID FIXED TO 99 FOR THIS DEMO
      // USE YOUR OWN ID IN YOUR PROJECT!
      echo $_CONTENT->save(99, $_POST["content"])
        ? "<div>SAVED</div>"
        : "<div>{$_CONTENT->error}</div>" ;
    }
    ?>
<?php
    // NOTE: CONTENT ID IS FIXED TO 99 FOR THIS DEMO...
    echo $_CONTENT->get(99);
  ?>

<script>
    //    var quill = new Quill('#editor', {
    //        modules: {
    //            toolbar: [
    //                ['bold', 'italic'],
    //                ['link', 'blockquote', 'code-block', 'image'],
    //                [{
    //                    list: 'ordered'
    //                }, {
    //                    list: 'bullet'
    //                }]
    //            ]
    //        },
    //        placeholder: 'Compose an epic...',
    //        theme: 'snow'
    //    });
    //   var myEditor = document.querySelector('#editor')
    //   var html = myEditor.children[0].innerHTML
    //
    //   var form = document.querySelector('#add_subcategory_form');
    //   form.onsubmit = function() {
    //       // Populate hidden form on submit     
    //       var about = document.querySelector('input[name=content]');
    //       let data = JSON.stringify(quill.getContents());
    //       about.value = data;
    //
    //       console.log("Submitted", $(form).serialize(), $(form).serializeArray());
    //
    //       // No back end to actually submit to!
    //       alert('Open the console to see the submit data!')
    //       return false;
    //   };
    //   var form = document.querySelector('form');
    //   form.onsubmit = function() {
    //       // Populate hidden form on submit
    //       var discussionContent = document.querySelector('input[name=content]');
    //       discussionContent.value = JSON.stringify(quill.getContents());
    //
    //       var url = "discussionsEditor.php";
    //       var data = stringify(quill.getContents());
    //       alert("the data is " + data);
    //       $.ajax('/jquery/submitData', {
    //           type: "POST",
    //           url: url,
    //           data: discussionContent,
    //
    //           success: function() {
    //               alert("Successfully sent to database");
    //           },
    //           error: function() {
    //               alert("Could not send to database");
    //           }
    //       });
    //       return false;
    //   };

    // Another way of initializing quill with options, will get into those later
    // Let's just get our precious content out....

    //     var options = {
    //       placeholder: 'Waiting for your precious content',
    //       theme: 'snow'
    //     };
    //     
    //     var editor = new Quill('#editor', options);
    //     var preciousContent = document.getElementById('myPrecious');
    //     var justTextContent = document.getElementById('justText');
    //     var justHtmlContent = document.getElementById('justHtml');
    //     
    //     editor.on('text-change', function() {
    //       var delta = editor.getContents();
    //       var text = editor.getText();
    //       var justHtml = editor.root.innerHTML;
    //       preciousContent.innerHTML = JSON.stringify(delta);
    //       justTextContent.innerHTML = text;
    //       justHtmlContent.innerHTML = justHtml;
    //     });

    // Further Reading:
    //https://quilljs.com/guides/working-with-deltas/
    //https://github.com/quilljs/quill/issues/774
</script>




<div class="add_subcategory_block_textarea">
<textarea id="mytextarea" name="content"> </textarea>
</div>